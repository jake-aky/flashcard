<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to Flashcards</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
        }

        .input-section textarea {
            width: 100%;
            min-height: 250px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .input-section textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .controls-row {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .input-group {
            flex: 1;
            min-width: 200px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            white-space: nowrap;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-generate {
            padding: 12px 40px;
            font-size: 1.1em;
        }

        .processing {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .flashcard-review {
            perspective: 1000px;
        }

        .flashcard {
            position: relative;
            width: 100%;
            min-height: 350px;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .flashcard-face {
            position: absolute;
            width: 100%;
            min-height: 350px;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            border-radius: 8px;
            font-size: 1.2em;
            text-align: center;
        }

        .flashcard-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .flashcard-back {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            transform: rotateY(180deg);
        }

        .card-label {
            position: absolute;
            top: 15px;
            left: 20px;
            font-size: 0.8em;
            opacity: 0.8;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .card-content {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .progress {
            flex: 1;
            text-align: center;
            font-size: 1.1em;
            color: #555;
            font-weight: 500;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .hint {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
            text-align: center;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-card .number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-card .label {
            color: #666;
            margin-top: 5px;
        }

        .flashcard-list {
            margin-top: 20px;
        }

        .flashcard-item {
            padding: 20px;
            border-bottom: 1px solid #eee;
            transition: background 0.2s;
        }

        .flashcard-item:hover {
            background: #f8f9ff;
        }

        .flashcard-item:last-child {
            border-bottom: none;
        }

        .flashcard-item .question {
            color: #667eea;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.05em;
        }

        .flashcard-item .answer {
            color: #555;
            line-height: 1.6;
        }

        .hidden {
            display: none;
        }

        .char-count {
            text-align: right;
            color: #999;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .example-text {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            border-left: 4px solid #667eea;
        }

        .example-text p {
            color: #666;
            font-size: 0.95em;
            margin-bottom: 8px;
        }

        .example-text code {
            display: block;
            background: white;
            padding: 10px;
            border-radius: 4px;
            margin-top: 5px;
            font-family: monospace;
            font-size: 0.9em;
            color: #333;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>üìù Text to Flashcards</h1>
            <p>Paste your study notes and generate in-depth flashcards instantly</p>
        </header>

        <!-- Input Section -->
        <div id="inputSection" class="card">
            <div class="input-section">
                <label for="textInput" style="display: block; margin-bottom: 10px; font-weight: 600; color: #333;">
                    Paste your study notes:
                </label>
                <textarea id="textInput" placeholder="Paste your notes here... The more detailed your notes, the better the flashcards will be!"></textarea>
                <div class="char-count">
                    <span id="charCount">0</span> characters
                </div>

                <div class="controls-row">
                    <div class="input-group">
                        <label for="cardCount">Number of flashcards:</label>
                        <input type="number" id="cardCount" value="10" min="1" max="50">
                    </div>
                    <button class="btn btn-generate" id="generateBtn">
                        ‚ú® Generate Flashcards
                    </button>
                </div>

                <div class="example-text">
                    <p><strong>üí° Tip:</strong> For best results, include:</p>
                    <code>‚Ä¢ Detailed explanations and context
‚Ä¢ Key concepts and definitions
‚Ä¢ Examples and applications
‚Ä¢ Important facts and relationships</code>
                </div>
            </div>
        </div>

        <!-- Processing Section -->
        <div id="processingSection" class="card hidden">
            <div class="processing">
                <div class="spinner"></div>
                <h2>Generating flashcards...</h2>
                <p style="margin-top: 10px; color: #666;">Creating in-depth questions from your notes</p>
            </div>
        </div>

        <!-- Review Section -->
        <div id="reviewSection" class="card hidden">
            <div class="flashcard-review">
                <div class="flashcard" id="flashcard">
                    <div class="flashcard-face flashcard-front">
                        <div class="card-label">Question</div>
                        <div class="card-content" id="questionText">Click to start</div>
                    </div>
                    <div class="flashcard-face flashcard-back">
                        <div class="card-label">Answer</div>
                        <div class="card-content" id="answerText">Answer</div>
                    </div>
                </div>
                <p class="hint">Click card to flip</p>
            </div>

            <div class="controls">
                <div class="progress">
                    Card <span id="currentCard">0</span> of <span id="totalCards">0</span>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-secondary" id="prevBtn">‚Üê Previous</button>
                    <button class="btn" id="nextBtn">Next ‚Üí</button>
                    <button class="btn btn-secondary" id="shuffleBtn">üîÄ Shuffle</button>
                    <button class="btn btn-secondary" id="newSetBtn">üìù New Set</button>
                </div>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="number" id="totalCount">0</div>
                    <div class="label">Total Cards</div>
                </div>
                <div class="stat-card">
                    <div class="number" id="reviewedCount">0</div>
                    <div class="label">Reviewed</div>
                </div>
                <div class="stat-card">
                    <div class="number" id="remainingCount">0</div>
                    <div class="label">Remaining</div>
                </div>
            </div>
        </div>

        <!-- Flashcard List -->
        <div id="listSection" class="card hidden">
            <h3 style="margin-bottom: 15px; color: #333;">All Flashcards</h3>
            <div class="flashcard-list" id="flashcardList"></div>
        </div>
    </div>

    <script>
        // State
        let flashcards = [];
        let currentIndex = 0;
        let reviewedCards = new Set();

        // DOM Elements
        const textInput = document.getElementById('textInput');
        const charCount = document.getElementById('charCount');
        const cardCount = document.getElementById('cardCount');
        const generateBtn = document.getElementById('generateBtn');
        const inputSection = document.getElementById('inputSection');
        const processingSection = document.getElementById('processingSection');
        const reviewSection = document.getElementById('reviewSection');
        const listSection = document.getElementById('listSection');
        const flashcard = document.getElementById('flashcard');
        const questionText = document.getElementById('questionText');
        const answerText = document.getElementById('answerText');
        const currentCard = document.getElementById('currentCard');
        const totalCards = document.getElementById('totalCards');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const shuffleBtn = document.getElementById('shuffleBtn');
        const newSetBtn = document.getElementById('newSetBtn');
        const flashcardList = document.getElementById('flashcardList');
        const totalCount = document.getElementById('totalCount');
        const reviewedCount = document.getElementById('reviewedCount');
        const remainingCount = document.getElementById('remainingCount');

        // Character counter
        textInput.addEventListener('input', () => {
            charCount.textContent = textInput.value.length;
            generateBtn.disabled = textInput.value.trim().length < 50;
        });

        // Generate flashcards
        generateBtn.addEventListener('click', async () => {
            const text = textInput.value.trim();
            const numCards = parseInt(cardCount.value);

            if (text.length < 50) {
                alert('Please enter at least 50 characters of text.');
                return;
            }

            if (numCards < 1 || numCards > 50) {
                alert('Please choose between 1 and 50 flashcards.');
                return;
            }

            await generateFlashcards(text, numCards);
        });

        async function generateFlashcards(text, numCards) {
            inputSection.classList.add('hidden');
            processingSection.classList.remove('hidden');

            try {
                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 4000,
                        messages: [{
                            role: 'user',
                            content: `You are an expert at creating high-quality, in-depth flashcards for studying. Given the following study notes, generate exactly ${numCards} flashcards.

IMPORTANT REQUIREMENTS:
1. Each flashcard must be SPECIFIC and IN-DEPTH based on the exact content provided
2. Questions should test understanding, not just recall
3. Include relevant details, examples, and context in answers
4. Cover different aspects and concepts from the notes
5. Questions should be clear and focused on one concept each
6. Answers should be comprehensive but concise (2-4 sentences ideal)
7. Use the actual terminology and examples from the notes
8. Make questions that test application and understanding, not just definitions

Return ONLY a valid JSON array in this exact format with no other text before or after:
[
  {"question": "Detailed question here...", "answer": "Comprehensive answer with specific details..."},
  {"question": "Another specific question...", "answer": "Detailed answer..."}
]

Study notes:
${text}`
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();
                const content = data.content[0].text.trim();

                // Extract JSON from response
                const jsonMatch = content.match(/\[[\s\S]*\]/);
                if (jsonMatch) {
                    flashcards = JSON.parse(jsonMatch[0]);

                    // Validate we got the right number
                    if (flashcards.length !== numCards) {
                        console.warn(`Expected ${numCards} cards, got ${flashcards.length}`);
                    }

                    currentIndex = 0;
                    reviewedCards.clear();

                    processingSection.classList.add('hidden');
                    reviewSection.classList.remove('hidden');
                    listSection.classList.remove('hidden');

                    displayFlashcard();
                    updateStats();
                    displayFlashcardList();
                } else {
                    throw new Error('Could not parse JSON from response');
                }
            } catch (error) {
                console.error('Error generating flashcards:', error);
                alert('Error generating flashcards. Please try again. Make sure your text is clear and sufficient.');
                resetToInput();
            }
        }

        function displayFlashcard() {
            if (flashcards.length === 0) return;

            const card = flashcards[currentIndex];
            questionText.textContent = card.question;
            answerText.textContent = card.answer;
            flashcard.classList.remove('flipped');

            currentCard.textContent = currentIndex + 1;
            totalCards.textContent = flashcards.length;

            reviewedCards.add(currentIndex);
            updateStats();
        }

        function updateStats() {
            totalCount.textContent = flashcards.length;
            reviewedCount.textContent = reviewedCards.size;
            remainingCount.textContent = flashcards.length - reviewedCards.size;
        }

        function displayFlashcardList() {
            flashcardList.innerHTML = flashcards.map((card, index) => `
                <div class="flashcard-item">
                    <div class="question">Q${index + 1}: ${card.question}</div>
                    <div class="answer">${card.answer}</div>
                </div>
            `).join('');
        }

        flashcard.addEventListener('click', () => {
            flashcard.classList.toggle('flipped');
        });

        prevBtn.addEventListener('click', () => {
            if (currentIndex > 0) {
                currentIndex--;
                displayFlashcard();
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentIndex < flashcards.length - 1) {
                currentIndex++;
                displayFlashcard();
            }
        });

        shuffleBtn.addEventListener('click', () => {
            flashcards = flashcards.sort(() => Math.random() - 0.5);
            currentIndex = 0;
            reviewedCards.clear();
            displayFlashcard();
            displayFlashcardList();
        });

        newSetBtn.addEventListener('click', resetToInput);

        function resetToInput() {
            inputSection.classList.remove('hidden');
            processingSection.classList.add('hidden');
            reviewSection.classList.add('hidden');
            listSection.classList.add('hidden');

            flashcards = [];
            currentIndex = 0;
            reviewedCards.clear();
        }

        // Initialize
        generateBtn.disabled = true;
    </script>
</body>

</html>
